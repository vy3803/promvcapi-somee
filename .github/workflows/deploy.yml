import ftp from "basic-ftp";
import fs from "fs";
import dotenv from "dotenv";
dotenv.config();

async function uploadFTP() {
    const client = new ftp.Client();
    client.ftp.verbose = true;

    try {
        // Kết nối FTP
        await client.access({
            host: process.env.FTP_HOST,
            user: process.env.FTP_USER,
            password: process.env.FTP_PASSWORD,
            secure: false
        });

        console.log("Đã kết nối FTP!");

        // Tạo thư mục nếu chưa tồn tại
        const remoteFolder = "/public_html/uploads";
        await client.ensureDir(remoteFolder);
        console.log("Đã tạo/kiểm tra thư mục:", remoteFolder);

        // File muốn upload
        const localFile = "test.txt";
        const remoteFile = "test.txt";

        // Kiểm tra file local có tồn tại không
        if (!fs.existsSync(localFile)) {
            console.log("❌ Không tìm thấy file local:", localFile);
            return;
        }

        // Upload file
        await client.uploadFrom(localFile, `${remoteFolder}/${remoteFile}`);
        console.log("✅ Upload thành công:", remoteFile);

    } catch (err) {
        console.error("❌ Lỗi FTP:", err);
    }

    client.close();
}

uploadFTP();
